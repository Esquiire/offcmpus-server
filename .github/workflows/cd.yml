name: CD

on:
  workflow_dispatch:
  push:
    branches:
      - "#11"

jobs:
  cd:
    name: Deploy to prod
    runs-on: [self-hosted, prod, aws, ec2]
    timeout-minutes: 5

    steps:
      - uses: actions/checkout@v2

      - name: Install dependencies
        run: npm install

      - name: Build
        run: npm run build

      # - name: Stop current app
      #   run: pm2 stop offcmpus_api_node_app

      # - name: Start new app
      #   run: pm2 start --name offcmpus_api_node_app server.js
      #   working-directory: dist

      # - name: Check pm2
      #   run: pm2 list
